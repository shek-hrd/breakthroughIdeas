<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pionex Investment Analysis</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="green-silver-theme">
    <header class="page-header">
        <div class="header-brand">
            <h1>Pionex Investment Analysis & Simulation Suite</h1>
            <p class="header-subtitle">Real-time monitoring, predictive insights, and automated strategy curation</p>
        </div>

        <section id="ideal-bot-section" class="ideal-bot-section">
            <div class="ideal-bot-header">
                <h2>Ideal Bot Intelligence</h2>
                <div class="analysis-meta">
                    <span>Latest analysis:</span>
                    <span id="ideal-bot-timestamp" class="timestamp">Analyzing…</span>
                </div>
                <button id="generate-ideal-bot" class="primary">Refresh Ideal Bot Analysis</button>
            </div>
        </section>

        <section id="ideal-bot-settings" class="ideal-bot-settings">
            <div class="settings-header">
                <h3>Current Ideal Bot Configuration</h3>
                <div class="bot-status">
                    <span id="bot-status" class="status-indicator">Analyzing Market...</span>
                    <span id="last-analysis" class="last-analysis">Last analysis: Never</span>
                </div>
            </div>
            <div id="bot-configuration" class="bot-configuration">
                <div class="config-grid">
                    <div class="config-item">
                        <label>Strategy:</label>
                        <span id="bot-strategy" class="config-value">Analyzing...</span>
                    </div>
                    <div class="config-item">
                        <label>Target Symbols:</label>
                        <span id="bot-symbols" class="config-value">Calculating...</span>
                    </div>
                    <div class="config-item">
                        <label>Expected APY:</label>
                        <span id="bot-expected-apy" class="config-value">Calculating...</span>
                    </div>
                    <div class="config-item">
                        <label>Risk Level:</label>
                        <span id="bot-risk-level" class="config-value">Assessing...</span>
                    </div>
                    <div class="config-item">
                        <label>Grid Levels:</label>
                        <span id="bot-grid-levels" class="config-value">Optimizing...</span>
                    </div>
                    <div class="config-item">
                        <label>Position Size:</label>
                        <span id="bot-position-size" class="config-value">Calculating...</span>
                    </div>
                </div>
                <div class="bot-actions">
                    <button id="apply-ideal-bot" class="accent">Apply Ideal Bot</button>
                    <button id="export-bot-config" class="secondary">Export Config</button>
                    <button id="reset-errors" class="secondary">Reset Errors</button>
                </div>
            </div>
        </section>

        <section class="control-bar">
            <div class="control-group">
                <label for="sort-by">Sort by:</label>
                <select id="sort-by">
                    <option value="apy">Current APY</option>
                    <option value="pionex-eval">Pionex Evaluation</option>
                    <option value="own-eval">My Evaluation</option>
                    <option value="simulation-income">Simulation Income</option>
                    <option value="min-duration">Minimal Duration</option>
                </select>
            </div>

            <div class="control-group">
                <label for="filter-duration">Filter by Duration:</label>
                <select id="filter-duration">
                    <option value="all">All</option>
                    <option value="10m">10 Minutes</option>
                    <option value="15m">15 Minutes</option>
                    <option value="1h">1 Hour</option>
                    <option value="3h">3 Hours</option>
                    <option value="16h">16 Hours</option>
                    <option value="24h">24 Hours</option>
                    <option value="7d">7 Days</option>
                </select>
            </div>

            <div class="control-group toggle">
                <button id="data-mode-toggle" class="toggle-button secondary">Start Live Data</button>
            </div>

            <div class="control-group refresh-control">
                <label for="refresh-rate-input">Refresh rate (s):</label>
                <input type="number" id="refresh-rate-input" min="1" value="5">
                <button id="apply-refresh-rate" class="secondary">Apply</button>
            </div>

            <div class="control-group button-group">
                <button id="pause-all" class="toggle-button secondary">Pause All</button>
                <button id="start-analysis" class="toggle-button accent">Start Analysis</button>
                <button id="refresh-data" class="toggle-button primary">Refresh Data</button>
            </div>

            <div class="control-group status">
                <span class="status-label">Next live update in:</span>
                <span class="status-value"><span id="countdown">--</span>s</span>
            </div>
        </section>
    </header>

    <main>
        <section id="alerts">
            <div id="global-error" class="alert hidden" role="alert"></div>
        </section>

        <section id="investment-options" class="content-section">
            <div class="section-heading">
                <h2>Available Investment Options</h2>
            </div>
            <div id="options-container" class="options-grid" aria-live="polite">
                <!-- Investment options will be dynamically populated here -->
            </div>
        </section>

        <section id="system-stats" class="content-section">
            <div class="section-heading">
                <h2>System Statistics</h2>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Memory Usage</div>
                    <div class="stat-value" id="memory-usage">Calculating...</div>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" id="memory-progress"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">CPU Load</div>
                    <div class="stat-value" id="cpu-load">Calculating...</div>
                    <div class="stat-progress">
                        <div class="stat-progress-bar" id="cpu-progress"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Running Simulations</div>
                    <div class="stat-value" id="running-simulations">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Bots</div>
                    <div class="stat-value" id="active-bots">0</div>
                </div>
            </div>
        </section>

        <section id="debug-console" class="content-section">
            <div class="section-heading">
                <h2>Debug Console & API Tester</h2>
                <button id="toggle-debug-console" class="secondary">Expand Debug Console</button>
            </div>
            <div id="debug-console-content" class="debug-console-content">
                <!-- API Curl Tester -->
                <div class="api-tester-section">
                    <h3>Pionex API Curl Tester</h3>
                    <div class="tester-controls">
                        <div class="control-group">
                            <label for="api-endpoint-select">API Endpoint:</label>
                            <select id="api-endpoint-select">
                                <option value="">Select an endpoint...</option>
                                <!-- Public Market Data Endpoints -->
                                <optgroup label="📊 Market Data (Public)">
                                    <option value="GET_MARKET_TICKERS">GET /api/v1/market/tickers - 24hr Ticker</option>
                                    <option value="GET_MARKET_TICKER">GET /api/v1/market/ticker/24hr - Single Ticker</option>
                                    <option value="GET_MARKET_DEPTH">GET /api/v1/market/depth - Order Book</option>
                                    <option value="GET_MARKET_TRADES">GET /api/v1/market/trades - Recent Trades</option>
                                    <option value="GET_MARKET_KLINES">GET /api/v1/market/klines - Kline Data</option>
                                    <option value="GET_COMMON_SYMBOLS">GET /api/v1/common/symbols - Symbol Info</option>
                                </optgroup>
                                <!-- Private Account Endpoints -->
                                <optgroup label="🔐 Account (Private)">
                                    <option value="GET_ACCOUNT_BALANCE">GET /api/v1/account/balance - Account Balance</option>
                                    <option value="GET_TRADE_ALL_ORDERS">GET /api/v1/trade/allOrders - All Orders</option>
                                    <option value="GET_TRADE_OPEN_ORDERS">GET /api/v1/trade/openOrders - Open Orders</option>
                                    <option value="POST_TRADE_ORDER">POST /api/v1/trade/order - Place Order</option>
                                    <option value="DELETE_TRADE_ORDER">DELETE /api/v1/trade/order - Cancel Order</option>
                                </optgroup>
                                <!-- WebSocket Endpoints -->
                                <optgroup label="🔗 WebSocket">
                                    <option value="WS_PUBLIC_STREAM">WebSocket Public Stream</option>
                                    <option value="WS_PRIVATE_STREAM">WebSocket Private Stream</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="request-method">Method:</label>
                            <select id="request-method">
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="DELETE">DELETE</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="symbol-input">Symbol:</label>
                            <input type="text" id="symbol-input" placeholder="e.g., BTC_USDT" value="BTC_USDT">
                        </div>

                        <button id="load-endpoint-params" class="secondary">Load Parameters</button>
                        <button id="send-api-request" class="accent">Send Request</button>
                    </div>

                    <!-- Dynamic Parameters Section -->
                    <div id="endpoint-parameters" class="endpoint-parameters" style="display: none;">
                        <h4>Request Parameters</h4>
                        <div id="parameters-container" class="parameters-container">
                            <!-- Parameters will be dynamically added here -->
                        </div>
                        <button id="add-parameter" class="secondary">Add Parameter</button>
                    </div>

                    <!-- Generated Curl Command -->
                    <div class="curl-output-section">
                        <h4>Generated cURL Command</h4>
                        <div class="curl-controls">
                            <button id="copy-curl" class="secondary">Copy cURL</button>
                            <button id="format-curl" class="secondary">Format</button>
                        </div>
                        <textarea id="curl-output" class="curl-output" readonly placeholder="Select an endpoint and configure parameters to generate cURL command..."></textarea>
                    </div>

                    <!-- Request/Response Section -->
                    <div class="request-response-section">
                        <div class="response-tabs">
                            <button class="tab-button active" data-tab="request">Request</button>
                            <button class="tab-button" data-tab="response">Response</button>
                        </div>
                        <div id="request-tab" class="tab-content">
                            <h5>Request Details</h5>
                            <pre id="request-details">No request sent yet...</pre>
                        </div>
                        <div id="response-tab" class="tab-content" style="display: none;">
                            <h5>Response</h5>
                            <pre id="response-details">No response yet...</pre>
                        </div>
                    </div>
                </div>

                <!-- Debug Log Section -->
                <div class="debug-log-section">
                    <div class="debug-controls">
                        <button id="clear-debug-log" class="secondary">Clear Log</button>
                        <button id="export-debug-log" class="secondary">Export Log</button>
                        <select id="debug-log-level">
                            <option value="all">All</option>
                            <option value="info">Info</option>
                            <option value="warn">Warning</option>
                            <option value="error">Error</option>
                        </select>
                    </div>
                    <div id="debug-log-container" class="debug-log-container">
                        <div class="debug-log-entry info">Debug console initialized. Ready for Pionex API operations.</div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div id="pionex-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="pionex-modal-title" aria-describedby="pionex-modal-description">
        <div class="modal-content">
            <button id="pionex-modal-close" class="modal-close" aria-label="Close Pionex login">&times;</button>
            <h2 id="pionex-modal-title">Pionex Login</h2>
            <p id="pionex-modal-description" class="modal-description">Authenticate securely with Pionex to enable live trading metrics.</p>
            <div id="pionex-modal-message" class="modal-message informational">Choose how you would like to proceed.</div>
            <div class="modal-actions">
                <button id="pionex-modal-try-login" class="accent">Attempt Secure Login</button>
                <button id="pionex-modal-mock-login" class="secondary">Use Mock Session</button>
            </div>
        </div>
    </div>

    <div id="api-key-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="api-key-modal-title" aria-describedby="api-key-modal-description">
        <div class="modal-content">
            <button id="api-key-modal-close" class="modal-close" aria-label="Close API key dialog">&times;</button>
            <h2 id="api-key-modal-title">Pionex API Configuration</h2>
            <p id="api-key-modal-description" class="modal-description">Enter your Pionex API credentials to enable automated bot creation and management.</p>

            <div class="form-group">
                <label for="api-key-input">API Key:</label>
                <input type="text" id="api-key-input" placeholder="Enter your Pionex API Key" autocomplete="off">
            </div>

            <div class="form-group">
                <label for="api-secret-input">API Secret:</label>
                <input type="password" id="api-secret-input" placeholder="Enter your Pionex API Secret" autocomplete="off">
            </div>

            <div class="form-group">
                <label for="trading-password-input">Trading Password:</label>
                <input type="password" id="trading-password-input" placeholder="Enter your trading password (if required)" autocomplete="off">
            </div>

            <div id="api-key-modal-message" class="modal-message informational">Your credentials are encrypted and stored locally only.</div>

            <div class="modal-actions">
                <button id="test-api-connection" class="secondary">Test Connection</button>
                <button id="save-api-credentials" class="accent">Save & Apply</button>
            </div>
        </div>
    </div>

    <div id="api-secret-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="api-secret-modal-title" aria-describedby="api-secret-modal-description">
        <div class="modal-content">
            <button id="api-secret-modal-close" class="modal-close" aria-label="Close API secret dialog">&times;</button>
            <h2 id="api-secret-modal-title">API Secret Required</h2>
            <p id="api-secret-modal-description" class="modal-description">This API endpoint requires authentication. Please provide your API secret to generate the signature.</p>

            <div class="form-group">
                <label for="api-secret-temp-input">API Secret:</label>
                <input type="password" id="api-secret-temp-input" placeholder="Enter your API secret for this request" autocomplete="off">
            </div>

            <div class="form-group">
                <label for="pionex-signature-input">Or PIONEX-SIGNATURE (if pre-calculated):</label>
                <input type="text" id="pionex-signature-input" placeholder="Enter pre-calculated signature (optional)" autocomplete="off">
            </div>

            <div id="api-secret-modal-message" class="modal-message informational">Your API secret is only used for this request and is not stored.</div>

            <div class="modal-actions">
                <button id="use-temp-secret" class="accent">Use for This Request</button>
                <button id="configure-permanent-secret" class="secondary">Configure Permanent Credentials</button>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>